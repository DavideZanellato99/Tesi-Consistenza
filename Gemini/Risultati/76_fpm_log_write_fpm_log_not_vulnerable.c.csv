"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-134","Uncontrolled Format String","The software uses a format string that is obtained from an untrusted source, which can enable an attacker to perform a denial of service, read from arbitrary memory locations, or write to arbitrary memory locations.","The code uses an attacker-controlled string as the format argument for the `strftime` function. Specifically, the `format` buffer, which can be populated from the `log_format` input via the `%{...}` syntax, is directly passed to `strftime` when processing the `%t` or `%T` log tokens. If an attacker can control the `log_format` string, they can inject invalid or malicious format specifiers into `strftime`, potentially leading to a denial of service (e.g., application crash) or information disclosure."
"2","True","CWE-134","Uncontrolled Format String","The software uses a format string that is obtained from an untrusted source, which can enable an attacker to perform a denial of service, read from arbitrary memory locations, or write to arbitrary memory locations.","The code uses an attacker-controlled string as the format argument for the `strftime` function. Specifically, the `format` buffer, which can be populated from the `log_format` input via the `%{...}` syntax, is directly passed to `strftime` when processing the `%t` or `%T` log tokens. If an attacker can control the `log_format` string, they can inject invalid or malicious format specifiers into `strftime`, potentially leading to a denial of service (e.g., application crash) or information disclosure."
"3","True","CWE-134","Uncontrolled Format String","The software uses a format string that is obtained from an untrusted source, which can enable an attacker to perform a denial of service, read from arbitrary memory locations, or write to arbitrary memory locations.","The code uses an attacker-controlled string as the format argument for the `strftime` function. Specifically, the `format` buffer, which can be populated from the `log_format` input via the `%{...}` syntax, is directly passed to `strftime` when processing the `%t` or `%T` log tokens. If an attacker can control the `log_format` string, they can inject invalid or malicious format specifiers into `strftime`, potentially leading to a denial of service (e.g., application crash) or information disclosure."
"4","True","CWE-126","Buffer Read-out-of-bounds","The software reads data past the end, or before the beginning, of an intended buffer. This can lead to crashes, information disclosure, or other unpredictable behavior.","The code uses strftime(tmp, sizeof(tmp) - 1, format, localtime(t)); where 'format' is derived from user input. If the formatted output from strftime would exceed the provided buffer size (128 bytes), strftime returns 0 and leaves the 'tmp' buffer in an indeterminate state, meaning it is not guaranteed to be null-terminated. Subsequently, snprintf(b, FPM_LOG_BUFFER - len, ""%s"", tmp); is called. If 'tmp' is not null-terminated, snprintf will read past the end of the 'tmp' buffer until it encounters a null byte, leading to an out-of-bounds read. This can result in information disclosure (leaking adjacent memory contents into the log) or a denial of service (crashing the application if an invalid memory address is accessed)."
"5","True","CWE-134","Uncontrolled Format String","The software uses a format string that is obtained from an untrusted source, which can enable an attacker to perform a denial of service, read from arbitrary memory locations, or write to arbitrary memory locations.","The code uses an attacker-controlled string as the format argument for the `strftime` function. Specifically, the `format` buffer, which can be populated from the `log_format` input via the `%{...}` syntax, is directly passed to `strftime` when processing the `%t` or `%T` log tokens. If an attacker can control the `log_format` string, they can inject invalid or malicious format specifiers into `strftime`, potentially leading to a denial of service (e.g., application crash) or information disclosure."
