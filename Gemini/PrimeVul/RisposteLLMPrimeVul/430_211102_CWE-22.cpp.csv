"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a path to an external resource that is intended to be restricted to a limited directory, but the product does not properly prevent the path from resolving to a location outside of that directory. This can occur when the product attempts to access a file or directory based on a path provided by an untrusted source, and the path contains directory traversal sequences (e.g., ""../"") or absolute paths that allow it to escape the intended directory. This can lead to arbitrary file creation, modification, or deletion, or information disclosure.","The code extracts files from an archive, including handling hard links. The `link` function is used to create hard links based on paths derived from untrusted archive content (`archive_entry_hardlink` and `archive_entry_pathname`). If the internal helper function `_g_path_get_relative_basename` (which is not provided) does not sufficiently sanitize these paths to prevent directory traversal (e.g., `../`) or the use of absolute paths (e.g., `/etc/passwd`), an attacker could craft a malicious archive. This could lead to creating a hard link from a sensitive system file (e.g., `/etc/passwd`) to a file within the extraction directory. If the code then proceeds to write data to this hard-linked file (which occurs if `archive_entry_size` is set and positive), it would overwrite the sensitive system file with arbitrary data from the archive, leading to arbitrary file overwrite and potential system compromise."
"2","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a path to an external resource that is intended to be restricted to a limited directory, but the product does not properly prevent the path from resolving to a location outside of that directory. This can occur when the product attempts to access a file or directory based on a path provided by an untrusted source, and the path contains directory traversal sequences (e.g., ""../"") or absolute paths that allow it to escape the intended directory. This can lead to arbitrary file creation, modification, or deletion, or information disclosure.","The code extracts files from an archive, including handling hard links. The `link` function is used to create hard links based on paths derived from untrusted archive content (`archive_entry_hardlink` and `archive_entry_pathname`). If the internal helper function `_g_path_get_relative_basename` (which is not provided) does not sufficiently sanitize these paths to prevent directory traversal (e.g., `../`) or the use of absolute paths (e.g., `/etc/passwd`), an attacker could craft a malicious archive. This could lead to creating a hard link from a sensitive system file (e.g., `/etc/passwd`) to a file within the extraction directory. If the code then proceeds to write data to this hard-linked file (which occurs if `archive_entry_size` is set and positive), it would overwrite the sensitive system file with arbitrary data from the archive, leading to arbitrary file overwrite and potential system compromise."
"3","True","CWE-59","Improper Link Resolution Before File Access ('Symlink Following')","The software attempts to access a file based on a pathname, but it does not properly prevent or control the resolution of symbolic links or hard links in that pathname, which can allow an attacker to access or modify files outside of the intended directory.","The code is vulnerable to arbitrary file overwrite due to improper handling of hard links. It creates hard links using link(oldname, newname) where oldname is derived from an attacker-controlled archive_entry_hardlink and newname from archive_entry_pathname. An attacker can specify oldname to point to an arbitrary system file (e.g., /etc/passwd). The code then proceeds to write data to this newly created hard link, effectively overwriting the target system file. This can lead to data corruption, denial of service, or privilege escalation. A potential directory traversal vulnerability also exists if _g_path_get_relative_basename does not properly sanitize paths from archive entries."
"4","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a path to an external resource that is intended to be restricted to a limited directory, but the product does not properly prevent the path from resolving to a location outside of that directory. This can occur when the product attempts to access a file or directory based on a path provided by an untrusted source, and the path contains directory traversal sequences (e.g., ""../"") or absolute paths that allow it to escape the intended directory. This can lead to arbitrary file creation, modification, or deletion, or information disclosure.","The code extracts files from an archive, including handling hard links. The `link` function is used to create hard links based on paths derived from untrusted archive content (`archive_entry_hardlink` and `archive_entry_pathname`). If the internal helper function `_g_path_get_relative_basename` (which is not provided) does not sufficiently sanitize these paths to prevent directory traversal (e.g., `../`) or the use of absolute paths (e.g., `/etc/passwd`), an attacker could craft a malicious archive. This could lead to creating a hard link from a sensitive system file (e.g., `/etc/passwd`) to a file within the extraction directory. If the code then proceeds to write data to this hard-linked file (which occurs if `archive_entry_size` is set and positive), it would overwrite the sensitive system file with arbitrary data from the archive, leading to arbitrary file overwrite and potential system compromise."
"5","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a path to an external resource that is intended to be restricted to a limited directory, but the product does not properly prevent the path from resolving to a location outside of that directory. This can occur when the product attempts to access a file or directory based on a path provided by an untrusted source, and the path contains directory traversal sequences (e.g., ""../"") or absolute paths that allow it to escape the intended directory. This can lead to arbitrary file creation, modification, or deletion, or information disclosure.","The code extracts files from an archive, including handling hard links. The `link` function is used to create hard links based on paths derived from untrusted archive content (`archive_entry_hardlink` and `archive_entry_pathname`). If the internal helper function `_g_path_get_relative_basename` (which is not provided) does not sufficiently sanitize these paths to prevent directory traversal (e.g., `../`) or the use of absolute paths (e.g., `/etc/passwd`), an attacker could craft a malicious archive. This could lead to creating a hard link from a sensitive system file (e.g., `/etc/passwd`) to a file within the extraction directory. If the code then proceeds to write data to this hard-linked file (which occurs if `archive_entry_size` is set and positive), it would overwrite the sensitive system file with arbitrary data from the archive, leading to arbitrary file overwrite and potential system compromise."
