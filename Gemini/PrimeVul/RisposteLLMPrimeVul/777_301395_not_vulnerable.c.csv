"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a filename to identify a file, but it does not sufficiently prevent an attacker from substituting a different file with the same name, or a link to a different file, between the time the product checks the filename and the time it accesses the file. This can lead to the product operating on an unintended file, potentially causing information disclosure, data corruption, or denial of service.","The code retrieves a directory entry name using readdir() and then attempts to get its stat information using fstatat(). If lp_posix_pathnames() returns false, the AT_SYMLINK_NOFOLLOW flag is not used, allowing fstatat() to follow symbolic links. This creates a Time-of-Check Time-of-Use (TOCTOU) race condition where an attacker could replace the original entry with a symbolic link to an arbitrary file between the readdir() call and the fstatat() call, leading to information disclosure or other unintended file operations."
"2","True","CWE-367","Time-of-check Time-of-use (TOCTOU) Race Condition","The product checks for a certain condition, but a race condition exists where the condition can change between the check and the use of the check's results. This can lead to unexpected behavior, privilege escalation, or other security issues.","The code retrieves a directory entry name using readdir and then uses this name in a subsequent fstatat call. If AT_SYMLINK_NOFOLLOW is not specified for fstatat (which depends on the value of lp_posix_pathnames()), a Time-of-Check to Time-of-Use (TOCTOU) race condition exists. An attacker could, between the readdir and fstatat calls, replace the legitimate file with a symbolic link to an arbitrary sensitive file. This would cause fstatat to operate on the attacker-controlled target, potentially leading to information disclosure or other unintended consequences."
"3","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a filename to identify a file, but it does not sufficiently prevent an attacker from substituting a different file with the same name, or a link to a different file, between the time the product checks the filename and the time it accesses the file. This can lead to the product operating on an unintended file, potentially causing information disclosure, data corruption, or denial of service.","The code retrieves a directory entry name using readdir() and then attempts to get its stat information using fstatat(). If lp_posix_pathnames() returns false, the AT_SYMLINK_NOFOLLOW flag is not used, allowing fstatat() to follow symbolic links. This creates a Time-of-Check Time-of-Use (TOCTOU) race condition where an attacker could replace the original entry with a symbolic link to an arbitrary file between the readdir() call and the fstatat() call, leading to information disclosure or other unintended file operations."
"4","True","CWE-59","Improper Link Resolution Before File Access ('Link Following')","The product uses a filename to identify a file, but it does not sufficiently prevent an attacker from substituting a different file with the same name, or a link to a different file, between the time the product checks the filename and the time it accesses the file. This can lead to the product operating on an unintended file, potentially causing information disclosure, data corruption, or denial of service.","The code retrieves a directory entry name using readdir() and then attempts to get its stat information using fstatat(). If lp_posix_pathnames() returns false, the AT_SYMLINK_NOFOLLOW flag is not used, allowing fstatat() to follow symbolic links. This creates a Time-of-Check Time-of-Use (TOCTOU) race condition where an attacker could replace the original entry with a symbolic link to an arbitrary file between the readdir() call and the fstatat() call, leading to information disclosure or other unintended file operations."
"5","True","CWE-367","Time-of-check Time-of-use (TOCTOU) Race Condition","The product checks for a certain condition, but a race condition exists where the condition can change between the check and the use of the check's results. This can lead to unexpected behavior, privilege escalation, or other security issues.","The code retrieves a directory entry name using readdir and then uses this name in a subsequent fstatat call. If AT_SYMLINK_NOFOLLOW is not specified for fstatat (which depends on the value of lp_posix_pathnames()), a Time-of-Check to Time-of-Use (TOCTOU) race condition exists. An attacker could, between the readdir and fstatat calls, replace the legitimate file with a symbolic link to an arbitrary sensitive file. This would cause fstatat to operate on the attacker-controlled target, potentially leading to information disclosure or other unintended consequences."
