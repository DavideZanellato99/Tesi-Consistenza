"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-835","Loop with Unreachable Exit Condition ('Infinite Loop')","The product contains a loop that does not terminate, or does not terminate within an expected period of time, which can lead to a denial of service.","The code iterates through an input string character by character using a while loop. In each iteration, it determines the length of the current character using enclen(reg->enc, p). If enclen returns 0 for an invalid or malformed character sequence, the pointer p will not advance (p += len). This will cause the while (p < end) loop to execute indefinitely, leading to an infinite loop and a Denial of Service (DoS). Although ONIGENC_GET_CASE_FOLD_CODES_BY_STR is called before enclen and might catch some invalid sequences, there could be edge cases where it returns a non-negative value (indicating no error or alternatives) while enclen subsequently returns 0 for the same malformed input."
"2","True","CWE-835","Loop with Unreachable Exit Condition ('Infinite Loop')","The product contains a loop that does not terminate, or does not terminate within an expected period of time, which can lead to a denial of service.","The code iterates through an input string character by character using a while loop. In each iteration, it determines the length of the current character using enclen(reg->enc, p). If enclen returns 0 for an invalid or malformed character sequence, the pointer p will not advance (p += len). This will cause the while (p < end) loop to execute indefinitely, leading to an infinite loop and a Denial of Service (DoS). Although ONIGENC_GET_CASE_FOLD_CODES_BY_STR is called before enclen and might catch some invalid sequences, there could be edge cases where it returns a non-negative value (indicating no error or alternatives) while enclen subsequently returns 0 for the same malformed input."
"3","True","CWE-400","Uncontrolled Resource Consumption","The product does not properly restrict the size or amount of resources that are used, which might be controlled by an untrusted input.","The code is vulnerable to uncontrolled resource consumption. The 'alt_num' variable, an integer, is multiplied by '(n + 1)' in a loop. If this multiplication results in an integer overflow, 'alt_num' can wrap around to a negative value. This bypasses the intended check 'if (alt_num > THRESHOLD_CASE_FOLD_ALT_FOR_EXPANSION)', which is designed to limit the expansion of alternative nodes. Consequently, the function can continue to allocate a large number of nodes via 'expand_case_fold_string_alt' without bound, leading to excessive memory usage and a denial of service. Additionally, there is a memory leak: if 'onig_node_str_cat' fails after 'snode' has been allocated by 'onig_node_new_str' and 'top_root' is still 'NULL_NODE', the allocated 'snode' is not freed, resulting in a leak."
"4","True","CWE-400","Uncontrolled Resource Consumption","The product does not properly restrict the size or amount of resources that are used, which might be controlled by an untrusted input.","The code is vulnerable to uncontrolled resource consumption. The 'alt_num' variable, an integer, is multiplied by '(n + 1)' in a loop. If this multiplication results in an integer overflow, 'alt_num' can wrap around to a negative value. This bypasses the intended check 'if (alt_num > THRESHOLD_CASE_FOLD_ALT_FOR_EXPANSION)', which is designed to limit the expansion of alternative nodes. Consequently, the function can continue to allocate a large number of nodes via 'expand_case_fold_string_alt' without bound, leading to excessive memory usage and a denial of service. Additionally, there is a memory leak: if 'onig_node_str_cat' fails after 'snode' has been allocated by 'onig_node_new_str' and 'top_root' is still 'NULL_NODE', the allocated 'snode' is not freed, resulting in a leak."
"5","True","CWE-835","Loop with Unreachable Exit Condition ('Infinite Loop')","The product contains a loop that does not terminate, or does not terminate within an expected period of time, which can lead to a denial of service.","The code iterates through an input string character by character using a while loop. In each iteration, it determines the length of the current character using enclen(reg->enc, p). If enclen returns 0 for an invalid or malformed character sequence, the pointer p will not advance (p += len). This will cause the while (p < end) loop to execute indefinitely, leading to an infinite loop and a Denial of Service (DoS). Although ONIGENC_GET_CASE_FOLD_CODES_BY_STR is called before enclen and might catch some invalid sequences, there could be edge cases where it returns a non-negative value (indicating no error or alternatives) while enclen subsequently returns 0 for the same malformed input."
