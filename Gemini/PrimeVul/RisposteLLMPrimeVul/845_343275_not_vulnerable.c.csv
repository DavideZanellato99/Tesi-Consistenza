"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-124","Buffer Underwrite ('Buffer Underflow')","The product attempts to access data from a memory buffer using an index or pointer that is outside of the buffer's boundary and is less than the lowest valid address that the buffer can hold. This out-of-bounds read can lead to a crash, information disclosure, or potentially arbitrary code execution.","The code contains a buffer underflow vulnerability in the memcpy operation within the #ifdef FTPWHO block. When the length of the name string (sl) is exactly equal to the size of the shm_data_cur->filename buffer, the calculation for the source pointer &name[sl - sizeof shm_data_cur->filename - 1U] results in &name[-1U]. This attempts to read from memory immediately preceding the name buffer, leading to an out-of-bounds read. This can cause a crash, information disclosure, or potentially arbitrary code execution."
"2","True","CWE-59","Improper Neutralization of Absolute Path in a Relative Path","The product uses a relative path that is expected to be restricted to a certain directory, but it contains an absolute path (e.g., a full path starting with /) or a path that resolves to an absolute path (e.g., via symbolic links), which causes the product to access a resource outside of the intended directory.","The doretr function uses open(name, O_RDONLY) to open files. The standard open() function follows symbolic links. The code does not use O_NOFOLLOW or perform an lstat() check on 'name' before opening to determine if 'name' itself is a symbolic link. This allows an attacker to create a symbolic link (e.g., 'mylink -> /etc/passwd') and request 'mylink', causing the server to open and potentially serve the content of '/etc/passwd' or any other file the server process has read access to, outside of the intended directory. The S_ISLNK(st.st_mode) check is performed on the fstat result of the opened file descriptor, which refers to the target of the symlink, not the symlink itself, and thus does not mitigate this issue."
"3","True","CWE-59","Improper Neutralization of Absolute Path in a Relative Path","The product uses a relative path that is expected to be restricted to a certain directory, but it contains an absolute path (e.g., a full path starting with /) or a path that resolves to an absolute path (e.g., via symbolic links), which causes the product to access a resource outside of the intended directory.","The doretr function uses open(name, O_RDONLY) to open files. The standard open() function follows symbolic links. The code does not use O_NOFOLLOW or perform an lstat() check on 'name' before opening to determine if 'name' itself is a symbolic link. This allows an attacker to create a symbolic link (e.g., 'mylink -> /etc/passwd') and request 'mylink', causing the server to open and potentially serve the content of '/etc/passwd' or any other file the server process has read access to, outside of the intended directory. The S_ISLNK(st.st_mode) check is performed on the fstat result of the opened file descriptor, which refers to the target of the symlink, not the symlink itself, and thus does not mitigate this issue."
"4","True","CWE-124","Buffer Underwrite ('Buffer Underflow')","The product attempts to access data from a memory buffer using an index or pointer that is outside of the buffer's boundary and is less than the lowest valid address that the buffer can hold. This out-of-bounds read can lead to a crash, information disclosure, or potentially arbitrary code execution.","The code contains a buffer underflow vulnerability in the memcpy operation within the #ifdef FTPWHO block. When the length of the name string (sl) is exactly equal to the size of the shm_data_cur->filename buffer, the calculation for the source pointer &name[sl - sizeof shm_data_cur->filename - 1U] results in &name[-1U]. This attempts to read from memory immediately preceding the name buffer, leading to an out-of-bounds read. This can cause a crash, information disclosure, or potentially arbitrary code execution."
"5","True","CWE-59","Improper Neutralization of Absolute Path in a Relative Path","The product uses a relative path that is expected to be restricted to a certain directory, but it contains an absolute path (e.g., a full path starting with /) or a path that resolves to an absolute path (e.g., via symbolic links), which causes the product to access a resource outside of the intended directory.","The doretr function uses open(name, O_RDONLY) to open files. The standard open() function follows symbolic links. The code does not use O_NOFOLLOW or perform an lstat() check on 'name' before opening to determine if 'name' itself is a symbolic link. This allows an attacker to create a symbolic link (e.g., 'mylink -> /etc/passwd') and request 'mylink', causing the server to open and potentially serve the content of '/etc/passwd' or any other file the server process has read access to, outside of the intended directory. The S_ISLNK(st.st_mode) check is performed on the fstat result of the opened file descriptor, which refers to the target of the symlink, not the symlink itself, and thus does not mitigate this issue."
