"iteration","is_vulnerable","assigned_cwe","assigned_cwe_name","cwe_description","explanation"
"1","True","CWE-190","Integer Overflow or Wraparound","The product performs a calculation that can produce an integer overflow or wraparound, when the input or resultant value is larger than the maximum value for the integer type, which can lead to other weaknesses such as a buffer overflow.","The code is vulnerable to an integer overflow that leads to a heap-based buffer overflow. Specifically, in the section handling tilde expansion (when filename is NULL), the size for a malloc call is calculated as dirlen + 2. If dirlen is sufficiently large (e.g., SIZE_MAX - 1), this addition will cause an integer overflow, resulting in dirlen + 2 wrapping around to a small value (e.g., 1). Consequently, malloc allocates a very small buffer. Immediately after, mempcpy attempts to copy dirlen bytes (a very large number) into this tiny buffer, leading to a severe heap buffer overflow. A similar vulnerability exists in the GLOB_MARK section where strlen(path) + 2 can overflow, leading to a small realloc buffer and subsequent strcpy overflow."
"2","True","CWE-674","Uncontrolled Recursion","The product contains a recursive function or algorithm that does not sufficiently limit the depth of recursion, which can lead to a stack overflow or other resource exhaustion issues when processing specially crafted input.","The glob function is recursive, calling itself for brace expansion and for globbing directory components. The code uses alloca_account which implies the use of alloca for allocating temporary buffers on the stack. If a malicious pattern is crafted to create an extremely deep recursion (e.g., nested brace expansions like a/{b/{c/{...}}} or deeply nested directory wildcards like a/*/b/*/c/... ), it can lead to excessive stack memory allocation and function call frames, resulting in a stack overflow and a denial-of-service condition. The code does not appear to implement any explicit recursion depth limits to mitigate this risk."
"3","True","CWE-190","Integer Overflow or Wraparound","The product performs a calculation that can produce an integer overflow or wraparound, when the input or resultant value is larger than the maximum value for the integer type, which can lead to other weaknesses such as a buffer overflow.","The code is vulnerable to an integer overflow that leads to a heap-based buffer overflow. Specifically, in the section handling tilde expansion (when filename is NULL), the size for a malloc call is calculated as dirlen + 2. If dirlen is sufficiently large (e.g., SIZE_MAX - 1), this addition will cause an integer overflow, resulting in dirlen + 2 wrapping around to a small value (e.g., 1). Consequently, malloc allocates a very small buffer. Immediately after, mempcpy attempts to copy dirlen bytes (a very large number) into this tiny buffer, leading to a severe heap buffer overflow. A similar vulnerability exists in the GLOB_MARK section where strlen(path) + 2 can overflow, leading to a small realloc buffer and subsequent strcpy overflow."
"4","True","CWE-674","Uncontrolled Recursion","The product contains a recursive function or algorithm that does not sufficiently limit the depth of recursion, which can lead to a stack overflow or other resource exhaustion issues when processing specially crafted input.","The glob function is recursive, calling itself for brace expansion and for globbing directory components. The code uses alloca_account which implies the use of alloca for allocating temporary buffers on the stack. If a malicious pattern is crafted to create an extremely deep recursion (e.g., nested brace expansions like a/{b/{c/{...}}} or deeply nested directory wildcards like a/*/b/*/c/... ), it can lead to excessive stack memory allocation and function call frames, resulting in a stack overflow and a denial-of-service condition. The code does not appear to implement any explicit recursion depth limits to mitigate this risk."
"5","True","CWE-674","Uncontrolled Recursion","The product contains a recursive function or algorithm that does not sufficiently limit the depth of recursion, which can lead to a stack overflow or other resource exhaustion issues when processing specially crafted input.","The glob function is recursive, calling itself for brace expansion and for globbing directory components. The code uses alloca_account which implies the use of alloca for allocating temporary buffers on the stack. If a malicious pattern is crafted to create an extremely deep recursion (e.g., nested brace expansions like a/{b/{c/{...}}} or deeply nested directory wildcards like a/*/b/*/c/... ), it can lead to excessive stack memory allocation and function call frames, resulting in a stack overflow and a denial-of-service condition. The code does not appear to implement any explicit recursion depth limits to mitigate this risk."
